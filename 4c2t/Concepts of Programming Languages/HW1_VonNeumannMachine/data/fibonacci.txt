GLOB n
GLOB res

FUN .fib n
    VAR i
    VAR res
    VAR tmp

    IF EQ0 n .trivial
    SUB n 1 -> n
    IF EQ0 n .trivial

    MOVE i 2
    LABEL .loop
        CALL .fib n -> tmp
        ADD res tmp -> res
        SUB i 1 -> i
        SUB n 1 -> n
        IF EQ0 i .nontrivial .loop
    LABEL .trivial
        RET 1
    LABEL .nontrivial
        RET res

FUN .main
    PRINTLN '"Calculate Fibonacci number (F_n)"'
    PRINT '"Enter n: "'
    READ -> n
    CALL .fib n -> res
    PRINT res
    EXIT
