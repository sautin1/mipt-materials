GLOB n
GLOB res

FUN .fib n
    VAR i
    VAR res
    VAR tmp

    IF EQ0 n .trivial
    SUB n 1 -> n
    IF EQ0 n .trivial

    MOV i 2
    LAB .loop
        CALL .fib n -> tmp
        ADD res tmp -> res
        SUB i 1 -> i
        SUB n 1 -> n
        IF EQ0 i .nontrivial .loop
    LAB .trivial
        RET 1
    LAB .nontrivial
        RET res

FUN .main
    PRINT '"Calculate Fibonacci numbers"'
    PRINT '"Enter a number: "'
    READ -> n
    CALL .fib n -> res
    PRINT res
